<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Be My Valentine</title>
  <style>
    :root {
      --sky-top: #6ec8ff;
      --sky-bottom: #d6f4ff;
      --ground-grass: #2ecb52;
      --ground-dirt: #a76934;
      --panel: #fffaf0;
      --ink: #1b1b1b;
      --yes: #3cd25f;
      --yes-dark: #1f9a3e;
      --no: #f25545;
      --no-dark: #d6382a;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100dvh;
      font-family: "Courier New", "Lucida Console", monospace;
      color: var(--ink);
      background: linear-gradient(180deg, var(--sky-top) 0%, var(--sky-bottom) 78%);
      overflow: hidden;
    }

    body::after {
      content: "";
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      height: 128px;
      background:
        linear-gradient(180deg, var(--ground-grass) 0 16px, transparent 16px),
        linear-gradient(180deg, #c9844a, var(--ground-dirt));
      border-top: 4px solid #1b1b1b;
      z-index: 0;
    }

    body.celebrate-bg {
      background: linear-gradient(180deg, #4b75d9 0%, #87b2ff 45%, #d4e4ff 78%);
    }

    body.celebrate-bg::after {
      background:
        linear-gradient(180deg, #39c45d 0 16px, transparent 16px),
        linear-gradient(180deg, #cf874a, #a56433);
      border-top: 4px solid #1b1b1b;
    }

    .scene {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 0;
    }

    .cloud {
      position: absolute;
      height: 34px;
      width: 120px;
      background: #fff;
      border: 4px solid #1b1b1b;
      image-rendering: pixelated;
    }

    .cloud::before,
    .cloud::after {
      content: "";
      position: absolute;
      background: #fff;
      border: 4px solid #1b1b1b;
    }

    .cloud::before {
      width: 38px;
      height: 38px;
      left: 10px;
      top: -22px;
    }

    .cloud::after {
      width: 42px;
      height: 42px;
      right: 14px;
      top: -24px;
    }

    .cloud-a { top: 78px; left: 8vw; }
    .cloud-b { top: 112px; right: 10vw; transform: scale(0.9); }

    .block-row {
      position: absolute;
      top: 42px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
    }

    .block {
      width: 42px;
      height: 42px;
      border: 4px solid #1b1b1b;
      background: #f4ab4f;
      color: #fff7d1;
      font-weight: 900;
      font-size: 1.2rem;
      display: grid;
      place-items: center;
      text-shadow: 2px 2px 0 #a36020;
    }

    .hill {
      position: absolute;
      bottom: 112px;
      width: 170px;
      height: 90px;
      border: 4px solid #1b1b1b;
      border-bottom: none;
      border-top-left-radius: 170px;
      border-top-right-radius: 170px;
      background: #2ecb52;
    }

    .hill-a { left: 6vw; }
    .hill-b { right: 8vw; transform: scale(0.92); }

    .hill::before,
    .hill::after {
      content: "";
      position: absolute;
      background: #1f8e3a;
      border: 3px solid #1b1b1b;
      border-radius: 50%;
    }

    .hill::before {
      width: 22px;
      height: 16px;
      left: 44px;
      top: 30px;
    }

    .hill::after {
      width: 17px;
      height: 12px;
      right: 38px;
      top: 48px;
    }

    .wrap {
      position: relative;
      min-height: 100dvh;
      display: grid;
      place-items: center;
      padding: 24px;
      z-index: 2;
    }

    .card {
      width: min(560px, 92vw);
      background: var(--panel);
      border: 4px solid #1b1b1b;
      border-radius: 10px;
      box-shadow: 8px 8px 0 #1b1b1b;
      padding: 36px 28px;
      text-align: center;
      position: relative;
    }

    h1 {
      margin: 0 0 22px;
      font-size: clamp(1.5rem, 4.8vw, 2.3rem);
      line-height: 1.25;
      text-shadow: 2px 2px 0 #fff;
    }

    .buttons {
      position: relative;
      min-height: 120px;
      margin-top: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 18px;
    }

    button {
      border: 4px solid #1b1b1b;
      border-radius: 8px;
      font-size: 1.05rem;
      font-weight: 700;
      padding: 12px 24px;
      min-height: 48px;
      cursor: pointer;
      transition: transform 0.08s ease, filter 0.2s ease;
      box-shadow: 4px 4px 0 #1b1b1b;
      letter-spacing: 0.3px;
      touch-action: manipulation;
    }

    button:hover { transform: translateY(-2px); filter: brightness(1.03); }

    #yesBtn {
      background: var(--yes);
      color: #083b16;
    }

    #yesBtn:active { background: var(--yes-dark); }

    #noBtn {
      background: var(--no);
      color: #fff4f3;
      user-select: none;
    }

    #noBtn:active { background: var(--no-dark); }

    body.celebrate-bg .scene { display: none; }
    body.celebrate-bg .wrap { padding: 0; }

    .celebration {
      display: none;
      animation: pop-in 0.35s steps(4);
      position: fixed;
      inset: 0;
      width: 100vw;
      max-width: none;
      border: none;
      border-radius: 0;
      box-shadow: none;
      padding: 0;
      background: #000;
      color: #fff;
      z-index: 3;
      overflow: hidden;
    }

    .celebration::before,
    .celebration::after {
      content: "";
      position: absolute;
      top: 0;
      bottom: 0;
      width: clamp(52px, 16vw, 220px);
      background:
        radial-gradient(circle at 10px 10px, #2f4ca9 3px, transparent 4px) 0 0 / 18px 18px,
        linear-gradient(180deg, #d33228, #b71f19);
      border-right: 4px solid #6d0f0a;
      z-index: 0;
    }

    .celebration::before { left: 0; }
    .celebration::after {
      right: 0;
      border-right: none;
      border-left: 4px solid #6d0f0a;
    }

    .mario-end {
      position: absolute;
      inset: 0 clamp(52px, 16vw, 220px);
      background: #000;
      border-left: 4px solid #8d8d8d;
      border-right: 4px solid #8d8d8d;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: space-between;
      z-index: 1;
    }

    .mario-hud {
      width: 100%;
      padding: 22px 20px 14px;
      display: flex;
      justify-content: space-around;
      font-size: clamp(1rem, 2.2vw, 2rem);
      font-weight: 900;
      letter-spacing: 1px;
      text-transform: uppercase;
    }

    .brick-row {
      width: 100%;
      height: 32px;
      background:
        repeating-linear-gradient(
          90deg,
          #f0f0f0 0 20px,
          #bbbbbb 20px 24px,
          #f0f0f0 24px 44px,
          #8e8e8e 44px 48px
        );
      border-top: 3px solid #777;
      border-bottom: 3px solid #777;
    }

    .mario-message {
      flex: 1;
      width: 100%;
      display: grid;
      place-items: center;
      text-align: center;
      padding: 20px;
      gap: 8px;
    }

    .mario-message h2 {
      margin: 0;
      font-size: clamp(1.3rem, 4vw, 3.2rem);
      line-height: 1.2;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .mario-message p {
      margin: 0;
      font-size: clamp(1rem, 2.6vw, 2rem);
      line-height: 1.35;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .gif {
      width: min(220px, 62vw);
      border-radius: 0;
      border: 4px solid #9b9b9b;
      box-shadow: none;
      image-rendering: pixelated;
    }

    @keyframes pop-in {
      from { transform: scale(0.88); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    canvas#fireworks {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
    }

    @media (max-width: 700px) {
      .block-row { top: 24px; }
      .block { width: 34px; height: 34px; font-size: 1rem; }
      .hill { width: 130px; height: 68px; bottom: 108px; }
      .cloud-b { display: none; }
      .mario-hud { font-size: 0.9rem; padding: 16px 10px 10px; }
      .brick-row { height: 24px; }
      .mario-message { padding: 14px; }
    }

    @media (max-width: 430px) {
      .wrap { padding: 12px; }
      .card { width: 96vw; padding: 24px 14px; }
      h1 { font-size: clamp(1.2rem, 7vw, 1.55rem); }
      .buttons { min-height: 110px; gap: 12px; }
      button { font-size: 0.98rem; padding: 11px 18px; min-height: 46px; }
      .celebration::before,
      .celebration::after { width: 42px; background-size: 14px 14px; }
      .mario-end { inset: 0 42px; }
      .mario-hud { font-size: 0.68rem; padding: 12px 6px 8px; }
      .brick-row { height: 18px; border-top-width: 2px; border-bottom-width: 2px; }
      .mario-message h2 { font-size: clamp(1rem, 7vw, 1.35rem); }
      .mario-message p { font-size: clamp(0.82rem, 4.6vw, 1rem); line-height: 1.28; }
      .gif { width: min(180px, 76vw); border-width: 3px; }
    }

    @media (hover: none) {
      button:hover { transform: none; filter: none; }
    }
  </style>
</head>
<body>
  <canvas id="fireworks"></canvas>
  <div class="scene" aria-hidden="true">
    <div class="cloud cloud-a"></div>
    <div class="cloud cloud-b"></div>
    <div class="block-row">
      <div class="block">?</div>
      <div class="block">?</div>
      <div class="block">?</div>
    </div>
    <div class="hill hill-a"></div>
    <div class="hill hill-b"></div>
  </div>

  <div class="wrap">
    <div class="card" id="questionCard">
      <h1 id="questionText">Devonちゃん, would you like to be my Valentine?</h1>
      <div class="buttons" id="buttonArea">
        <button id="yesBtn">Yes</button>
        <button id="noBtn" aria-label="No">No</button>
      </div>
    </div>

    <div class="card celebration" id="celebrationCard">
      <div class="mario-end" aria-hidden="true">
        <div class="mario-hud">
          <span>MARIO 1UP</span>
          <span>WORLD 8-4</span>
          <span>TIME 239</span>
        </div>
        <div class="brick-row"></div>
        <div class="mario-message">
          <h2 id="celebrationText">Yayyyy!</h2>
          <p>Happy Valentine's Day!  </p> <p>Can't wait to see you again!  </p>
          <img
            class="gif"
            src="https://media.giphy.com/media/3oriO6qJiXajN0TyDu/giphy.gif"
            alt="Dancing celebration"
          />
        </div>
        <div class="brick-row"></div>
      </div>
    </div>
  </div>

  <script>
    const noBtn = document.getElementById("noBtn");
    const yesBtn = document.getElementById("yesBtn");
    const buttonArea = document.getElementById("buttonArea");
    const questionCard = document.getElementById("questionCard");
    const celebrationCard = document.getElementById("celebrationCard");
    const questionText = document.getElementById("questionText");
    const celebrationText = document.getElementById("celebrationText");

    questionText.textContent = "Devonちゃん, would you like to be my Valentine?";
    celebrationText.textContent = "Yayyyy!";

    let noIsEscaping = false;

    function pinNoButtonForEscape() {
      if (noIsEscaping) return;
      const areaRect = buttonArea.getBoundingClientRect();
      const btnRect = noBtn.getBoundingClientRect();
      noBtn.style.position = "absolute";
      noBtn.style.left = btnRect.left - areaRect.left + "px";
      noBtn.style.top = btnRect.top - areaRect.top + "px";
      noIsEscaping = true;
    }

    function moveNoButton() {
      pinNoButtonForEscape();
      const areaRect = buttonArea.getBoundingClientRect();
      const btnRect = noBtn.getBoundingClientRect();

      const maxX = areaRect.width - btnRect.width;
      const maxY = areaRect.height - btnRect.height;

      const x = Math.max(0, Math.random() * maxX);
      const y = Math.max(0, Math.random() * maxY);

      noBtn.style.left = x + "px";
      noBtn.style.top = y + "px";
    }

    ["mouseenter", "mousedown", "touchstart", "click"].forEach((event) => {
      noBtn.addEventListener(event, (e) => {
        e.preventDefault();
        moveNoButton();
      });
    });

    yesBtn.addEventListener("click", () => {
      questionCard.style.display = "none";
      celebrationCard.style.display = "block";
      document.body.classList.add("celebrate-bg");
      startFireworks();
    });

    const canvas = document.getElementById("fireworks");
    const ctx = canvas.getContext("2d");
    let particles = [];
    let running = false;
    const isSmallScreen = window.matchMedia("(max-width: 430px)").matches;

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }

    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    function burst(x, y) {
      const count = isSmallScreen ? 30 : 50;
      for (let i = 0; i < count; i++) {
        const angle = (Math.PI * 2 * i) / count;
        const speed = Math.random() * 4 + 1.8;
        particles.push({
          x,
          y,
          vx: Math.cos(angle) * speed,
          vy: Math.sin(angle) * speed,
          life: 70 + Math.random() * 25,
          hue: Math.random() * 360,
          size: Math.random() * 2.6 + 1.4,
        });
      }
    }

    function animate() {
      if (!running) return;

      ctx.fillStyle = "rgba(0, 0, 0, 0.14)";
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      for (let i = particles.length - 1; i >= 0; i--) {
        const p = particles[i];
        p.x += p.vx;
        p.y += p.vy;
        p.vy += 0.025;
        p.life -= 1;

        if (p.life <= 0) {
          particles.splice(i, 1);
          continue;
        }

        ctx.beginPath();
        ctx.fillStyle = `hsla(${p.hue}, 100%, 60%, ${Math.max(0, p.life / 95)})`;
        ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
        ctx.fill();
      }

      if (Math.random() < (isSmallScreen ? 0.05 : 0.08)) {
        burst(Math.random() * canvas.width, Math.random() * canvas.height * 0.6 + 40);
      }

      requestAnimationFrame(animate);
    }

    function startFireworks() {
      if (running) return;
      running = true;
      for (let i = 0; i < 4; i++) {
        burst(Math.random() * canvas.width, Math.random() * canvas.height * 0.6 + 40);
      }
      animate();
    }
  </script>
</body>
</html>
